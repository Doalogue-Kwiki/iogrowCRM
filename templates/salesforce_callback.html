<!DOCTYPE html>
<html>
<head>
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab|Abel:300,400'
          rel='stylesheet' type='text/css'>
    <script type="text/javascript" src="https://storage.googleapis.com/iogrowgs/jquery.min.js"></script>
    <script type="text/javascript" src="https://js.stripe.com/v2/"></script>
    <link rel="stylesheet" href="/static/src/css/stripe-form.css">
    <script src="https://fb.me/react-0.14.3.js"></script>
    <script src="https://fb.me/react-dom-0.14.3.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
    <script src="/static/src/js/stripe-form.react.js" type="text/babel"></script>
</head>
<style>

    body{
  background-color: #F8F8F8;
  font-family: "Roboto",sans-serif !important;
}
#payment-btn{
  color: white;
    border: 2px solid #0A90EE;
    background-color: #0A90EE;
    border-radius: 6px;
    width: 177px;
    height: 50px;
    font-size: 18px;
    font-weight: 400px;
}
.content{
   padding-top: 20px;
     border-radius: 16px;
   border: 1px solid #3CA4EE;
     width: 550px;
     margin-top: 150px;
    /* min-height: 500px;*/
     background-color: white;
     -webkit-box-shadow: 0px 2px 5px 2px rgba(222,222,222,1);
     -moz-box-shadow: 0px 2px 5px 2px rgba(222,222,222,1);
     box-shadow: 0px 2px 5px 2px rgba(222,222,222,1);
     border-top: 5px #0A9AD7#0A9AD7 solid;
     margin-bottom:25px;
     box-sizing: border-box;
}
.container{
 width: 100%;
 margin: auto;
 margin-bottom:40px;
 background-color:#F8F8F8;
}
.row{
  display: block;
  margin: 0 -15px;
}
.row:after, .row:before {
   display: table;
   content: " ";
   box-sizing: border-box;
}
.row:after {
     clear: both;
 }
 .imgLeft, .message{
     position: relative;
   min-height: 1px;
   padding-right: 15px;
   padding-left: 15px;
   float: left;
   box-sizing: border-box;
   width: 100%;
   margin-bottom: 10px;
 }
 .imgLeft{
  width: 39%;
 }
 .imgLeft img{
  width: 98%;
 }
 .message{
  width: 60%;
 }
.message h3{
  font-size: 23px;
    font-weight: 500;
}
.col-6, .col-7, .col-5{
 position: relative;
 min-height: 1px;
 padding-right: 15px;
 padding-left: 15px;
 float: left;
 box-sizing: border-box;
 width: 100%;
 margin-bottom: 10px;
}

@media (min-width: 480px){
   .content{
    /* width:80%;*/
     margin-left:10%;
   }
   .col-7{
      width: 58.333333333333336%
   }
   .col-5{
      width: 41.66666666666667%
   }
}
@media (min-width: 678px){
   .content{
    /* width:80%;*/
     margin:auto;
     margin-bottom: 30px;
     margin-top: 150px;
   }
  .col-6{
     width: 50%;
   }
}
@media (min-width: 992px){
   .content{
   /* width:80%;*/
     margin:auto;
     margin-top: 150px;
     margin-bottom: 40px;
   }
}
@media (min-width: 1200px){
   .content{
    /* width:40%;*/
     margin:auto;
     margin-bottom: 40px;
     margin-top: 150px;
       padding-top: 20px;
   }

}
    .trialh3{
        margin-bottom:10px;margin-top: 0px;
    }
    .trialp{
        font-size: 15px; margin-top:0px;
    }
</style>
<body>
  <div id="login-successful">
  </div>

<script type="text/babel">
    $( document ).ready(function() {
        var OAuthHelper = {};
        var match = window.location.href.match(/code=([^&]+)/) ;
        var parentWindow;
        if (window.opener){
              parentWindow = window.opener.parent;
        }
        var code = '';
        if (match) {
              code = decodeURIComponent(match[1]);
        };

        var StripeConfig = {
            'stripePublicKey': 'pk_live_4Xa3cFwLO3vTgdjpjnC6gmAD',
            'paymenetSuccessful': function paymentSuccessfulHandler(response){
                  $.ajax({
                      type: 'POST',
                      url: '/sfsubscriber',
                      success: function(result) {
                          if(typeof (WebViewBridge) !== 'undefined'){
                                WebViewBridge.send(JSON.stringify(OAuthHelper));
                          }else{
                              parentWindow.postMessage(OAuthHelper,
                                "*");
                          }

                          window.close();
                      },
                      error:function(result){
                            console.log(result);
                      },
                      data: {token:JSON.stringify(response),email:OAuthHelper.user_email}
                  });
            }
        }
        $.ajax({
                type: 'GET',
                url: '/sfconnect',
                datatype:'json',
                success: function(result) {
                   window.close();
                },
                error:function(result){
                    var response = result.responseText;
                    var rr= response.replace(/'/g,"\"");
                    var oauthResult = JSON.parse(rr);
                    OAuthHelper=oauthResult;
                    if(oauthResult.show_checkout === "true"){
                        ReactDOM.render(<window.ActivationNotice />, document.getElementById('login-successful'));
                    }else{
                        if(typeof (WebViewBridge) !== 'undefined'){
                            WebViewBridge.send(JSON.stringify(OAuthHelper));
                        }
                        else{
                            parentWindow.postMessage(OAuthHelper,
                                    "*");
                        }
                        window.close();
                    }
                    // window.close();

                },
                data: {code: code}
        });
    });
  </script>
</body>
</html>