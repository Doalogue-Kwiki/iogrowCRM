<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8" > <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9" > <![endif]-->
<!--[if !IE]><!--> <html xmlns:ng="http://angularjs.org"> <!--<![endif]-->
<!-- BEGIN HEAD -->
<head>
  <meta charset="utf-8" />
  <title>i/oGrow Engine Platform</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <meta content="" name="description" />
  <meta content="" name="author" />
  <!-- BEGIN GLOBAL MANDATORY STYLES -->
  <link href="static/plugins/bootstrap/css/bootstrap.min.css"  rel="stylesheet" type="text/css"/>
  <link href="static/plugins/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css"/>
  <link href="static/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
  <link href="static/css/style-metro.css"  rel="stylesheet" type="text/css"/>
  <link href="static/css/style.css"  rel="stylesheet" type="text/css"/>
  <link href="static/css/style-responsive.css" rel="stylesheet" type="text/css"/>
  
  <link href="static/plugins/uniform/css/uniform.default.css"  rel="stylesheet" type="text/css"/>
  <link href="static/plugins/bootstrap-switch/static/stylesheets/bootstrap-switch-metro.css" rel="stylesheet" type="text/css"/>
  <link rel="stylesheet" type="text/css" href="static/plugins/select2/select2_metro.css" />
  <link rel="stylesheet" href="static/css/datetimepicker.css"/>
  <link rel="stylesheet" href="static/css/bootstrap-wysihtml5.css"/>
  <link href="static/css/themes/light.css"  rel="stylesheet" type="text/css" id="style_color"/>
  

  <!-- END GLOBAL MANDATORY STYLES -->
  <link rel="shortcut icon" href="favicon.ico" />
  <script type="text/javascript">
  (function() {
    var po = document.createElement('script');
    po.type = 'text/javascript'; po.async = true;
    po.src = 'https://plus.google.com/js/client:plusone.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(po, s);
  })();
  </script>
</head>

<body class="page-header-fixed">
  <!-- BEGIN HEADER -->   
  <div class="header navbar navbar-inverse navbar-fixed-top">
    <!-- BEGIN TOP NAVIGATION BAR -->
    <div class="navbar-inner">
      <div class="container-fluid">
        <!-- BEGIN LOGO -->
        <a class="brand" href="/#/accounts/">
        <img src="static/img/IO_Grow.png" width="125" alt="logo"  /> 
        </a>
        <!-- END LOGO -->
        <!-- BEGIN RESPONSIVE MENU TOGGLER -->
        <a href="javascript:;" class="btn-navbar collapsed" data-toggle="collapse" data-target=".nav-collapse">
        <img src="static/img/menu-toggler.png" alt="" />
        </a>   
             <ul class="nav search-form-top" ng-controller="SearchFormController"> 
                  <li>    
                    <form class="form-inline ng-pristine ng-valid" ng-submit="executeSearch(searchQuery)">
                      <div class="input-append row-fluid">
                        <input type="text" ng-model="searchQuery" typeahead="result as result.title + ' (' + result.type + ')' for result in results | filter:$viewValue | limitTo:8" typeahead-on-select="selectResult()" class="input-xlarge" placeholder="Search">
                       <button class="gbqfb gbqfb-hvr"><span class="gbqfi"></span></button>
                      </div>
                    </form>
                  </li> 
              </ul>

           
        <!-- END RESPONSIVE MENU TOGGLER -->            
        <!-- BEGIN TOP NAVIGATION MENU --> 
                    
        <ul class="nav pull-right">
          <!-- BEGIN NOTIFICATION DROPDOWN -->   
          
          <!-- END NOTIFICATION DROPDOWN -->
          <!-- BEGIN INBOX DROPDOWN -->
          
          <!-- END INBOX DROPDOWN -->
          <!-- BEGIN TODO DROPDOWN -->
          
          <!-- END TODO DROPDOWN -->               
          <!-- BEGIN USER LOGIN DROPDOWN -->
          <li class="dropdown user">
            <a href="{{user.google_public_profile_url}}" target="_blank" class="dropdown-toggle" >
            <img alt="" src="{{user.google_public_profile_photo_url}}" width="29" />
            <span class="username">{{user.google_display_name}}</span>
            
            </a>
            
          </li>
          <!-- END USER LOGIN DROPDOWN -->
          <!-- END USER LOGIN DROPDOWN -->
        </ul>
        <ul class="nav pull-right">
          <!-- BEGIN NOTIFICATION DROPDOWN -->   
          
          <!-- END NOTIFICATION DROPDOWN -->
          <!-- BEGIN INBOX DROPDOWN -->
          
          <!-- END INBOX DROPDOWN -->
          <!-- BEGIN TODO DROPDOWN -->
          
          <!-- END TODO DROPDOWN -->               
          <!-- BEGIN USER LOGIN DROPDOWN -->
          <li class="dropdown user">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">
            <img alt="" src="static/img/glyphicons_156_show_thumbnails.png" width="20" />
            
            <span class="username"> {{active_app.label}}</span>
            <i class="icon-angle-down"></i>
            </a>

            <ul class="dropdown-menu">
            <!-- {{apps}}-->
               {%for application in apps %}
                     <li><a href="/apps/{{ application.id }}"><i class="icon-th"></i> {{application.label}}</a></li>
                
               {%endfor%}

             
            </ul>
          </li>
          <!-- END USER LOGIN DROPDOWN -->
          <!-- END USER LOGIN DROPDOWN -->
        </ul> 
        <ul class="nav pull-right">
          <!-- BEGIN NOTIFICATION DROPDOWN -->   
          
          <!-- END NOTIFICATION DROPDOWN -->
          <!-- BEGIN INBOX DROPDOWN -->
          
          <!-- END INBOX DROPDOWN -->
          <!-- BEGIN TODO DROPDOWN -->
          
          <!-- END TODO DROPDOWN -->               
          <!-- BEGIN USER LOGIN DROPDOWN -->
    
          <li>
            <a href="/live/companies/{{org_id}}/" target="new">
            My company
            </a>
            
          </li>
          
          <!-- END USER LOGIN DROPDOWN -->
          <!-- END USER LOGIN DROPDOWN -->
        </ul>
        <!-- END TOP NAVIGATION MENU --> 
      </div>
    </div>
    <!-- END TOP NAVIGATION BAR -->
  </div>
  <div id="errorModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
                <h3 id="myModalLabel">{{_("Error")}}</h3>
              </div>
              <div class="modal-body">
                
                  
                    <p>An error was occured. Please try again</p>

                  
                    
                    </fieldset>
                
              </div>
              <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">{{_("Close")}}</button>
              
              </div>
              
       </div>
<div ng-view class="page-container row-fluid">

</div>
  <!-- END CONTAINER -->
  <!-- BEGIN FOOTER -->
  <div class="footer">
    <div class="footer-inner">
      2013 &copy; i/oGrow.
    </div>
    <div class="footer-tools">
      <!--span class="go-top">
      <i class="icon-angle-up"></i>
      </span-->
    </div>
  </div>
  <!-- END FOOTER -->
  <!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->
  <!-- BEGIN CORE PLUGINS -->   

  <script src="static/plugins/jquery-2.0.3.min.js"  type="text/javascript"></script>
  <script src="static/app/scripts/vendor/select2.min.js" ></script>
   <script src="static/app/scripts/vendor/angular.js" ></script>
   <script src="static/app/scripts/vendor/ui-select2.js" ></script>
  <script type="text/javascript">
    window.is_signed_in = false;
    function auth() {
        var config = {
      'client_id': '{{CLIENT_ID}}',
          'scope': 'https://www.googleapis.com/auth/userinfo.email',
          'immediate' : true
        };
        gapi.auth.authorize(config, function(authResult) {
          console.log('in authCallback');
          console.log(authResult);
          if (authResult && !authResult.error){
              console.log('login complete');
              console.log(gapi.auth.getToken());
              window.logged_in = true;  
          } else{
            var config_for_new = {
              'client_id': '{{CLIENT_ID}}',
              'scope': 'https://www.googleapis.com/auth/userinfo.email',
              'immediate' : false
             };
            gapi.auth.authorize(config_for_new);

          }
          
        });
      }
      var apisToLoad;
  var callback = function() {
    console.log('callback');
    if (--apisToLoad == 0) {
      signin(true, userAuthed);

    }
  }

    function loadGapi() {
       window.is_signed_in = false;
       window.authResult = undefined;
       var apisToLoad;




        var ROOT = '/_ah/api';

   //var ROOT = 'https://gcdc2013-iogrow.appspot.com/_ah/api';





            var callback = function() {
        if (--apisToLoad == 0) {
          apiLoaded();
        }
       }

      apisToLoad = 2; // must match number of calls to gapi.client.load()
      console.log('before loading');
      gapi.client.load('crmengine', 'v1', callback, ROOT);
      gapi.load('picker', {'callback': callback});
      
      
    }
    function apiLoaded(){

      // When the API is loaded start angularJS app
      var $injector = angular.bootstrap(document, ['crmEngine']); 
            console.log('angular bootstraped');
      console.log('before redirection');
      if (!window.location.hash){
      window.location.replace('{{active_app.url}}');
      };
    }

    function signin(mode, callback) {
      gapi.auth.authorize({client_id: "{{CLIENT_ID}}",
        scope: "https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/calendar", immediate: mode},
        callback);
    }
    

    function userAuthed() {
      
          
          var $injector = angular.bootstrap(document, ['crmEngine']); 
            console.log('angular bootstraped');
          
          // User is signed in, call my Endpoint
      
     
    }

    function callbackoauth(){
       console.log('oauth2 loaded');
    }

  </script>

  <script src="https://apis.google.com/js/client.js?onload=loadGapi">
  </script>
  <script src="static/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
  <script src="static/app/scripts/vendor/ui-bootstrap-0.5.0.js" ></script>
  <script src="static/app/scripts/vendor/ui-bootstrap-tpls-0.5.0.js"></script>
  <script src="static/app/scripts/vendor/moment.min.js"></script>
  <script src="static/app/scripts/vendor/datetimepicker.js"></script>



  <script src="static/app/scripts/services/authservices.js"></script>
  <script src="static/app/scripts/services/mapservices.js"></script>
  <script src="static/app/scripts/services/productservices.js"></script>
  <script src="static/app/scripts/services/accountservices.js"></script>
  <script src="static/app/scripts/services/contactservices.js"></script>
  <script src="static/app/scripts/services/opportunityservices.js"></script>
  

  <!--script src="static/app/scripts/services/services.js" ></script-->
  <script src="static/app/scripts/services/topicservices.js" ></script>
  <script src="static/app/scripts/services/taskservices.js" ></script>
  <script src="static/app/scripts/services/eventservices.js" ></script>
  <script src="static/app/scripts/services/leadservices.js" ></script>
  <script src="static/app/scripts/services/userservices.js"></script>
  <script src="static/app/scripts/services/groupservices.js"></script>
  <script src="static/app/scripts/services/liveservices/showservices.js" ></script>
  <script src="static/app/scripts/services/liveservices/feedbackservices.js" ></script>
  <script src="static/app/scripts/services/liveservices/companyprofileservices.js" ></script>
  <script src="static/app/scripts/services/noteservices.js" ></script>
  <script src="static/app/scripts/services/commentservices.js" ></script>
   <script src="static/app/scripts/services/settingservices.js" ></script>

  <script src="static/app/scripts/app.js" ></script>
   <script src="static/app/scripts/controllers/productcontrollers.js" ></script>
   <script src="static/app/scripts/controllers/searchcontrollers.js" ></script>
  <script src="static/app/scripts/controllers/accountcontrollers.js" ></script>
  <script src="static/app/scripts/controllers/contactcontroller.js"></script>  
  <script src="static/app/scripts/controllers/opportunitycontroller.js" ></script>
  <script src="static/app/scripts/controllers/livecontrollers/showcontrollers.js" ></script>
  <script src="static/app/scripts/controllers/livecontrollers/productvideoscontrollers.js" ></script>
  <script src="static/app/scripts/controllers/livecontrollers/customerstoriescontrollers.js" ></script>
   <script src="static/app/scripts/controllers/livecontrollers/feedbackscontrollers.js" ></script>
  <script src="static/app/scripts/controllers/notecontrollers.js"></script> 
  <script src="static/app/scripts/controllers/taskcontrollers.js"></script>
  <script src="static/app/scripts/controllers/eventcontrollers.js"></script>
  <!--Admin controllers-->
  <script src="static/app/scripts/controllers/usercontrollers.js" ></script>
  <script src="static/app/scripts/controllers/groupcontrollers.js" ></script>
  <script src="static/app/scripts/controllers/settingscontrollers.js" ></script>
  
  <script src="static/app/scripts/controllers/livecontrollers/comp_profilecontrollers.js"></script>
  <script src="static/app/scripts/controllers/leadcontrollers.js" ></script>

  <script src="static/app/scripts/services/leadservices.js" ></script>
  <script src="static/app/scripts/controllers/casecontrollers.js" ></script>
  <script src="static/app/scripts/services/caseservices.js" ></script>
  <script src="static/app/scripts/controllers/needcontrollers.js" ></script>


  
  <!-- IMPORTANT! Load jquery-ui-1.10.1.custom.min.js before bootstrap.min.js to fix bootstrap tooltip conflict with jquery ui tooltip -->
  <script src="static/plugins/jquery-ui/jquery-ui-1.10.1.custom.min.js" type="text/javascript"></script>      
  
   <script type="text/javascript" src="static/app/scripts/vendor/bootstrap-datetimepicker.min.js"></script>
  <script src="static/plugins/bootstrap-hover-dropdown/twitter-bootstrap-hover-dropdown.min.js" type="text/javascript" ></script>
  <!--[if lt IE 9]>
  <script src="static/plugins/excanvas.min.js"></script>
  <script src="static/plugins/respond.min.js"></script>  
  <![endif]-->   
  <script src="static/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
  <script src="static/plugins/jquery.blockui.min.js" type="text/javascript"></script>  
  <script src="static/plugins/jquery.cookie.min.js" type="text/javascript"></script>
  <script src="static/plugins/uniform/jquery.uniform.min.js" type="text/javascript" ></script>
  <script src="static/plugins/bootstrap-switch/static/js/bootstrap-switch.js" type="text/javascript" ></script>
  
  <script src="static/app/scripts/vendor/wysihtml5-0.3.0.min.js" ></script>
  <script src="static/app/scripts/vendor/bootstrap-wysihtml5.js" ></script>
  <script src="http://maps.google.com/maps/api/js?sensor=true" type="text/javascript"></script>
  <script src="/static/app/scripts/vendor/jquery.ui.map.min.js"></script> 
  <script type="text/javascript" src="/static/app/scripts/vendor/jquery.ui.map.services.js"></script>

  <!-- END CORE PLUGINS -->
  

 
  <!-- END JAVASCRIPTS -->
</body>
<!-- END BODY -->
</html>
