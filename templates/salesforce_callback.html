<!DOCTYPE html>
<html>
<head>
    <link href='http://fonts.googleapis.com/css?family=Roboto+Slab|Abel:300,400'
          rel='stylesheet' type='text/css'>
    <script type="text/javascript" src="https://storage.googleapis.com/iogrowgs/jquery.min.js"></script>
    <script src="https://checkout.stripe.com/checkout.js"></script>
    <!-- <link href="" rel="stylesheet" type="text/css"/> -->
    <style>
        input[type="text"]:focus{
            border: 1px solid #4C4B4A;
            outline: none;
        }
        .content{
              width: 100%;
              margin-bottom:15px; 
              min-height: 500px;
              background-color: #F6F6F6;  
              -webkit-box-shadow: 0px 2px 5px 2px rgba(222,222,222,1);
              -moz-box-shadow: 0px 2px 5px 2px rgba(222,222,222,1);
              box-shadow: 0px 2px 5px 2px rgba(222,222,222,1);
              border-top: 5px #0A9AD7 solid;
              padding:25px; margin-bottom:25px;
              box-sizing: border-box;
        } 
        .container{
          width: 100%;
          margin: auto; 
          margin-bottom:40px
        }
        .row{
           display: block;
           margin: 0 -15px;
        }
        .row:after, .row:before {
            display: table;
            content: " ";
            box-sizing: border-box;
        }
        .row:after {
              clear: both;
          }
        .col-6, .col-7, .col-5{
          position: relative;
          min-height: 1px;
          padding-right: 15px;
          padding-left: 15px;
          float: left;
          box-sizing: border-box;
          width: 100%;
          margin-bottom: 10px;
        }
        .form-control{
            background-color: #fff;
            -webkit-box-shadow: none;
            box-sizing: border-box;
            box-shadow: none;
            color: #333;
            border: 1px solid #e5e5e5;
            border-radius: 3px;
            font-size: 14px;
            font-weight: 400;
            -webkit-transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
            width: 100%;
            height: 34px;
            padding: 6px 12px;
            line-height: 1.428571429;
            vertical-align: middle;
         }
        .label-control{
          display: block;
          margin-bottom: 5px;
          font-size: 12px;
          font-weight: 300;
        }
        .cardsimgscontainer{
          margin-top: 15px;
        }
        .featuresList{
            margin: 0px;
            padding: 0px;
            list-style: none;
        }
        .logoHeader{
            font-family: Abel;
            font-weight: 300;
        }
        .logoHeader img{
              width: 60px;
              height: auto;
              vertical-align: middle;
        }
        .content{
          font-family: Roboto;
        }
        .title{
            font-size: 14px;
             font-weight: 500;
        }
        .featuresList li{
          font-size: 12px;
          font-weight: 300px;
          margin-bottom: 10px; 
        }
        .im-El{
          font-weight: 600;
        }
        .more-infos{
          margin-bottom: 25px;
        }
        #payment-btn{
              color: white;
              border: 2px solid #359CDC;
              background-color: #3BB8EE;
              border-radius: 6px;
              width: 250px;
              height: 65px;
              font-size: 20px;
        }
        .payment-btn-container{
            text-align: center;
        }
        .cardsimgscontainer:after{
          content: " ";
          clear: both;
          display: table;
        }
        .footerStripe:after{
          content: " ";
          clear: both;
          display: table;
        }
        .footerStripe .stripe{
          height: 20px;
          display: inline-block;
          padding: 10px;
          vertical-align: middle;
          background-color: #323B3F;
          color: #EAEBEC;
          font-family: Roboto;
          font-size: 12px;    border-radius: 5px; float:right !important
        }
        @media (min-width: 480px){
            .content{
              width:80%;
              margin-left:10%; 
            }
            .col-7{
               width: 58.333333333333336%
            }
            .col-5{
               width: 41.66666666666667%
            }
        }
        @media (min-width: 678px){
            .content{
              width:80%;
              margin:auto; 
              margin-bottom: 30px;
            }
           .col-6{
              width: 50%;
            }
        }
        @media (min-width: 992px){
            .content{
              width:80%;
              margin:auto; 
              margin-bottom: 40px;
            }
            .container{
               width: 85%;
               margin: auto; 
            }
        }
        @media (min-width: 1200px){
            .content{
              width:80%;
              margin:auto; 
              margin-bottom: 40px;
            }
            .container{
               width: 65%;
               margin: auto; 
            }
        }
    </style>
</head>
<body>
  <div class="container">
      <h2 class="logoHeader">
          <img src="static/img/128.png" alt="">
      <span style="color: #0E7BB6;">Copy</span><span>lead for Salesforce</span>
    </h2>
    <div class="content">
        <p>You are one step closer to unlock great sales opportunities!</p>
         <form action="">
           <div class="contact-infos">
             <h3 class="title">
               1. Contact information
             </h3>
             <div class="row">
               <div class="col-6">
                  <label for="fullname" class="label-control">Full name</label>
                  <input type="text" id="fullname" class="form-control">
               </div>
               <div class="col-6">
                  <label for="email" class="label-control">Email</label>
                  <input type="text" id="email" class="form-control">
               </div>
             </div>
           </div>
           <div class="payment-infos">
             <h3  class="title">
               2. Payment information
             </h3>
             <div class="row">
                <div class="col-6">
                    <label for="cardnumber" class="label-control">Credit Card Number</label>
                    <input type="text" id="cardnumber" class="form-control">
                    <div class="cardsimgscontainer">
                          <img src="/static/img/visa.png"
                               style=" width:40px; margin-bottom: 4px;" alt="">
                          <img src="/static/img/mastercard.png" alt=""
                               style=" width:40px; margin-bottom: 4px;">
                          <img src="/static/img/american-express.png" alt=""
                               style=" width:40px; margin-bottom: 4px;">
                          <img src="/static/img/discover.png" alt=""
                               style=" width:40px; margin-bottom: 4px;">
                          <img src="/static/img/JCB.png" alt=""
                               style=" width:40px; margin-bottom: 4px;">
                     </div>
                 </div>
                 <div class="col-6">
                     <div class="row">
                       <div class="col-7">
                          <label for="expiration" class="label-control">Expiration (MM /YYYY)</label>
                          <input type="text" id="expiration" class="form-control">
                       </div>
                       <div class="col-5">
                          <label for="scode" class="label-control">Security code</label>
                          <input type="text" id="scode" class="form-control">
                          <div class="cardsimgscontainer">
                              <img src="/static/img/cvc.png"
                                   style=" width:40px; margin-bottom: 4px;float: right;" alt="">
                         </div>
                       </div>
                     </div>
                 </div>
             </div>
           </div>
           <div class="more-infos">
              <h3  class="title">
               3. What are you paying for is
             </h3>
             <ul class="featuresList">
               <li><span class="im-El">Unlimited leads per month</span></li>
               <li><span class="im-El">Social networks integrations</span></li>
               <li>Linkedin, Gmail, Twitter, facebook, AngelList</li>
             </ul>
           </div>
           <div class="payment-btn-container">
             <input type="submit" value="Pay 10$/month" id="payment-btn">
           </div>

         </form>
      </div>
      <div class="footerStripe">
          <div class="stripe" style="">  
         <p style="margin:inherit; line-height: 18px;"><span>Powered by </span><span style="
    font-size: 16px;
    color: white;
    font-weight: 500;
">stripe</span></p> 
          </div>
      </div>
  </div>  

  <script>
      var OAuthHelper = {};
      var handler = StripeCheckout.configure({
      key: 'pk_live_4Xa3cFwLO3vTgdjpjnC6gmAD',
      image: 'https://storage.googleapis.com/iogrow-gs/128.png',
      token: function(token) {
        // Use the token to create the charge with a server-side script.
        // You can access the token ID with `token.id`
        // send the token to stripe
        //sfsubscriber
        console.log('token');
        console.log(token);

        $.ajax({
            type: 'POST',
            url: '/sfsubscriber',

            success: function(result) {
              console.log(result);
              parentWindow.postMessage(OAuthHelper,
                  "*");
              window.close();
            },
            error:function(result){
              console.log(result);  
                
            },
            data: {token:JSON.stringify(token),email:OAuthHelper.user_email}
        });
        
      }
      });

      

      // Close Checkout on page navigation
      $(window).on('popstate', function() {
        handler.close();
      });
      var match = window.location.href.match(/code=([^&]+)/) ; 
      var parentWindow = window.opener.parent;
      console.log(match);
      $.ajax({
            type: 'GET',
            url: '/sfconnect',
            datatype:'json',

            success: function(result) {
              console.log('i am in connectServer show me result please');
              console.log(result);
              
               window.close();
            },
            error:function(result){
                var response = result.responseText;
                var rr= response.replace(/'/g,"\"");
                console.log('yyyyy');
                console.log(JSON.parse(rr));
                var oauthResult = JSON.parse(rr);
                OAuthHelper=oauthResult;
                if(oauthResult.show_checkout=="true"){
                    handler.open({
                    name: 'ioGrow LLC',
                    description: 'Copylead to Salesforce',
                    amount: 1000,
                    email:oauthResult.user_email
                  });
                }else{
                    parentWindow.postMessage(OAuthHelper,
                              "*");
                    window.close();
                }
                
                
                // window.close();
                
            },
            data: {code:decodeURIComponent(match[1])}
        });
    
    


  </script>
</body>
</html>